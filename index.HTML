<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ارسال پیام به تلگرام</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <link href="https://cdn.fontcdn.ir/iran-sans/iran-sans.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <style>
      body {
        font-family: 'IRANSans', sans-serif;
        background: linear-gradient(135deg, #6b7280 0%, #1e3a8a 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #1f2937;
        padding: 1rem;
      }
      .container {
        background: rgba(255, 255, 255, 0.97);
        border-radius: 1.5rem;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        padding: 2rem;
        max-width: 38rem;
        width: 100%;
        animation: slideIn 0.6s ease-out;
        position: relative;
        overflow: hidden;
      }

      @keyframes slideIn {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
      }

      h1 {
        color: #1e3a8a;
        font-size: 2.25rem;
        font-weight: 800;
        text-align: center;
        margin-bottom: 2.5rem;
        background: linear-gradient(90deg, #1e3a8a, #60a5fa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        position: relative;
        letter-spacing: -0.025em;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      h1::after {
        content: '';
        width: 80px;
        height: 5px;
        background: linear-gradient(90deg, #3b82f6, #60a5fa);
        display: block;
        margin: 0.75rem auto;
        border-radius: 3px;
        transition: width 0.4s ease;
      }
      h1:hover::after {
        width: 120px;
      }

      label {
        color: #1e3a8a;
        font-weight: 600;
        font-size: 0.95rem;
        margin-bottom: 0.5rem;
        display: block;
      }

      .input-field {
        background-color: #f8fafc;
        border: 1px solid #cbd5e1;
        border-radius: 0.75rem;
        padding: 0.75rem 1.25rem;
        color: #1e3a8a;
        transition: all 0.3s ease;
        width: 100%;
        font-size: 1rem;
      }
      .input-field:focus {
        border-color: #3b82f6;
        box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        background-color: #ffffff;
        outline: none;
      }
      textarea.input-field {
        resize: vertical;
        min-height: 100px;
      }

      .btn {
        background: linear-gradient(90deg, #1e3a8a, #3b82f6);
        color: white;
        font-weight: 600;
        padding: 0.8rem 2rem;
        border-radius: 0.75rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }
      .btn:hover {
        background: linear-gradient(90deg, #3b82f6, #1e3a8a);
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      }
      .btn:active {
        transform: scale(0.98);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      }
      .btn i {
        font-size: 1.2rem;
      }

      .form-radio {
        accent-color: #3b82f6;
        margin-left: 0.5rem;
      }

      .footer-link {
        margin-top: 2rem;
        text-align: center;
        font-size: 0.9rem;
        color: #6b7280;
      }
      .copyable-link-style {
        color: #1e3a8a;
        font-weight: 600;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }
      .copyable-link-style:hover {
        color: #3b82f6;
      }
      .copyable-link-style i {
        color: #3b82f6;
        transition: color 0.3s ease;
      }
      .copyable-link-style:hover i {
        color: #1e3a8a;
      }

      .result-message {
        padding: 1rem;
        border-radius: 0.5rem;
        margin-top: 1rem;
        animation: fadeIn 0.5s ease-in;
      }
      .result-message.success {
        background-color: #dcfce7;
        color: #15803d;
      }
      .result-message.error {
        background-color: #fee2e2;
        color: #b91c1c;
      }
      .result-message.info {
        background-color: #dbeafe;
        color: #1e3a8a;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
      }

      /* پاسخ‌گویی برای موبایل */
      @media (max-width: 640px) {
        .container {
          padding: 1.5rem;
          margin: 0.5rem;
        }
        h1 {
          font-size: 1.75rem;
        }
        .btn {
          padding: 0.75rem 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>تست بات و ارسال پیام به تلگرام</h1>

      <form id="telegram-form">
        <div class="mb-5">
          <label for="token">توکن ربات (Bot Token):</label>
          <input
            type="text"
            id="token"
            placeholder="مثال: 1234567890:AbCdEfGhIjKlMnOpQrStUvWxYz123456"
            class="input-field"
          />
        </div>

        <div class="mb-5">
          <label for="chat-id">
            آیدی چت/کاربر (Chat/User ID):
            <span class="text-xs font-normal">(آیدی عددی یا آیدی کانال/گروه با @)</span>
          </label>
          <input
            type="text"
            id="chat-id"
            placeholder="مثال: 123456789 یا @MyChannelUsername"
            class="input-field"
          />
        </div>

        <div class="mb-5">
          <label for="message">متن پیام:</label>
          <textarea
            id="message"
            rows="4"
            placeholder="متن پیام خود را اینجا بنویسید..."
            class="input-field"
          ></textarea>
        </div>

        <div class="mb-5">
          <label>وضعیت اتصال برای ارسال پیام:</label>
          <div class="flex items-center space-x-4 space-x-reverse mt-2">
            <label class="inline-flex items-center">
              <input type="radio" name="connection_status" value="no_vpn" checked class="form-radio h-4 w-4" />
              <span class="mr-2">بدون فیلترشکن وصلم</span>
            </label>
            <label class="inline-flex items-center mr-4">
              <input type="radio" name="connection_status" value="with_vpn" class="form-radio h-4 w-4" />
              <span class="mr-2">با فیلترشکن وصلم</span>
            </label>
          </div>
        </div>

        <div class="flex items-center justify-center mt-6">
          <button type="submit" id="send-message-btn" class="btn">
            <i class="fas fa-paper-plane"></i>
            ارسال پیام
          </button>
        </div>
      </form>

      <div id="result" class="text-center"></div>
      <div id="copy-message" class="text-center text-sm mt-4"></div>

      <div class="footer-link">
        تلگرام ما:
        <span class="copyable-link-style" onclick="copyToClipboard('IR_NADER@')" title="برای کپی آیدی کلیک کنید">
          <bdi>@IR_NADER</bdi>
          <i class="fab fa-telegram-plane"></i>
        </span>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      const copyToClipboard = async (text) => {
        const copyMsgDiv = document.getElementById('copy-message');
        try {
          await navigator.clipboard.writeText(text);
          copyMsgDiv.innerHTML = '<p class="result-message success">آیدی در حافظه کپی شد! ✅</p>';
        } catch (err) {
          console.error('Failed to copy text: ', err);
          const textarea = document.createElement('textarea');
          textarea.value = text;
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);
          copyMsgDiv.innerHTML = '<p class="result-message success">آیدی کپی شد! (روش جایگزین)</p>';
        }
        setTimeout(() => (copyMsgDiv.innerHTML = ''), 3000);
      };

      const sendMessageToTelegram = (token, chatId, message, connectionStatus) => {
        const baseUrl = connectionStatus === 'with_vpn' 
          ? 'https://api.telegram.org' 
          : 'https://telegram-api-proxy-anonymous.pages.dev/api';
        
        axios
          .get(`${baseUrl}/bot${token}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`)
          .then(handleResponse)
          .catch(handleError);
      };

      const handleResponse = (response) => {
        const resultDiv = document.getElementById('result');
        if (response.data.ok) {
          resultDiv.innerHTML = '<p class="result-message success">پیام با موفقیت ارسال شد</p>';
        } else {
          const errorDescription = response.data.description || 'خطای نامشخص';
          resultDiv.innerHTML = `<p class="result-message error">خطا در ارسال پیام: ${errorDescription}</p>`;
        }
      };

      const handleError = (error) => {
        document.getElementById('result').innerHTML = `<p class="result-message error">خطا در اتصال: ${error.message}</p>`;
      };

      document.getElementById('telegram-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const token = document.getElementById('token').value.trim();
        const chatId = document.getElementById('chat-id').value.trim();
        const message = document.getElementById('message').value.trim();
        const connectionStatus = document.querySelector('input[name="connection_status"]:checked').value;
        const resultDiv = document.getElementById('result');

        if (token && chatId && message) {
          resultDiv.innerHTML = '<p class="result-message info">در حال ارسال...</p>';
          sendMessageToTelegram(token, chatId, message, connectionStatus);
        } else {
          resultDiv.innerHTML = '<p class="result-message error">لطفاً همه فیلدها را پر کنید.</p>';
        }
      });
    </script>
  </body>
</html>